diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/bootstrap.inc drops-6/includes/bootstrap.inc
--- pressflow6/includes/bootstrap.inc	2018-11-26 10:27:54.000000000 -0800
+++ drops-6/includes/bootstrap.inc	2018-04-25 14:17:08.000000000 -0700
@@ -417,6 +417,41 @@ function conf_init() {
   if (file_exists('./'. conf_path() .'/settings.php')) {
     include_once './'. conf_path() .'/settings.php';
   }
+  // Load environmental config, if present.
+  if (isset($_SERVER['PRESSFLOW_SETTINGS'])) {
+    $pressflow_settings = json_decode($_SERVER['PRESSFLOW_SETTINGS'], TRUE);
+    foreach ($pressflow_settings as $key => $value) {
+      // One level of depth should be enough for $conf and $database.
+      if ($key == 'conf') {
+        foreach($value as $conf_key => $conf_value) {
+          $conf[$conf_key] = $conf_value;
+        }
+      }
+      else {
+        $$key = $value;
+      }
+    }
+    // D7 to D6-style DB config conversion:
+    if (is_array($databases)) {
+      $db_url = '';
+      foreach ($databases as $name => $data) {
+        foreach ($data as $type => $info) {
+          if ($type == 'default') {
+            $db_url = _convert_d7_db_to_d6($info);
+          }
+          if ($type == 'slave') {
+            $db_slave_url = array();
+            if (!is_array($info)) {
+              $info = array($info);
+            }
+            foreach ($info as $slave) {
+              $db_slave_url[] = _convert_d7_db_to_d6($slave);
+            }
+          }
+        }
+      }
+    }
+  }
 
   // Ignore the placeholder URL from default.settings.php.
   if (isset($db_url) && $db_url == 'mysql://username:password@localhost/databasename') {
@@ -493,6 +528,20 @@ function conf_init() {
 }
 
 /**
+ * Additional function to convert D7-style $database info arrays to
+ * D6-style $db_url strings.
+ *
+ * @param $info
+ *    A D7-style database info array.
+ *
+ * @return
+ *    A D6-style $db_url string.
+ */
+function _convert_d7_db_to_d6($info) {
+  return sprintf("%s://%s:%s@%s:%s/%s", $info['driver'], $info['username'], $info['password'], $info['host'], $info['port'], $info['database']);
+}
+
+/**
  * Returns and optionally sets the filename for a system item (module,
  * theme, etc.). The filename, whether provided, cached, or retrieved
  * from the database, is only returned if the file exists.
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/common.inc drops-6/includes/common.inc
--- pressflow6/includes/common.inc	2018-11-26 10:27:54.000000000 -0800
+++ drops-6/includes/common.inc	2018-03-28 13:25:57.000000000 -0700
@@ -366,7 +366,7 @@ function drupal_site_offline() {
   drupal_set_header($_SERVER['SERVER_PROTOCOL'] .' 503 Service unavailable');
   drupal_set_title(t('Site off-line'));
   print theme('maintenance_page', filter_xss_admin(variable_get('site_offline_message',
-    t('@site is currently under maintenance. We should be back shortly. Thank you for your patience.', array('@site' => variable_get('site_name', 'Pressflow'))))));
+    t('@site is currently under maintenance. We should be back shortly. Thank you for your patience.', array('@site' => variable_get('site_name', 'Pantheon'))))));
 }
 
 /**
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/install.inc drops-6/includes/install.inc
--- pressflow6/includes/install.inc	2018-11-26 10:27:54.000000000 -0800
+++ drops-6/includes/install.inc	2016-05-18 14:57:13.000000000 -0700
@@ -114,7 +114,7 @@ function drupal_install_profile_name() {
     if (function_exists($function)) {
       $details = $function();
     }
-    $name = isset($details['name']) ? $details['name'] : 'Pressflow';
+    $name = isset($details['name']) ? $details['name'] : 'Pantheon';
   }
 
   return $name;
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/locale.inc drops-6/includes/locale.inc
--- pressflow6/includes/locale.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/includes/locale.inc	2016-05-18 14:57:13.000000000 -0700
@@ -1813,7 +1813,7 @@ function _locale_export_po_generate($lan
 
   if (!isset($header)) {
     if (isset($language)) {
-      $header = '# '. $language->name .' translation of '. variable_get('site_name', 'Pressflow') ."\n";
+      $header = '# '. $language->name .' translation of '. variable_get('site_name', 'Pantheon') ."\n";
       $header .= '# Generated by '. $user->name .' <'. $user->mail .">\n";
       $header .= "#\n";
       $header .= "msgid \"\"\n";
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/mail.inc drops-6/includes/mail.inc
--- pressflow6/includes/mail.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/includes/mail.inc	2016-05-18 14:57:13.000000000 -0700
@@ -101,7 +101,7 @@ function drupal_mail($module, $key, $to,
     'MIME-Version'              => '1.0',
     'Content-Type'              => 'text/plain; charset=UTF-8; format=flowed; delsp=yes',
     'Content-Transfer-Encoding' => '8Bit',
-    'X-Mailer'                  => 'Pressflow'
+    'X-Mailer'                  => 'Pantheon'
   );
   if ($default_from) {
     // To prevent e-mail from looking like spam, the addresses in the Sender and
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/theme.inc drops-6/includes/theme.inc
--- pressflow6/includes/theme.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/includes/theme.inc	2016-05-18 14:57:13.000000000 -0700
@@ -1870,10 +1870,10 @@ function template_preprocess_page(&$vari
 
   // Construct page title
   if (drupal_get_title()) {
-    $head_title = array(strip_tags(drupal_get_title()), variable_get('site_name', 'Pressflow'));
+    $head_title = array(strip_tags(drupal_get_title()), variable_get('site_name', 'Pantheon'));
   }
   else {
-    $head_title = array(variable_get('site_name', 'Pressflow'));
+    $head_title = array(variable_get('site_name', 'Pantheon'));
     if (variable_get('site_slogan', '')) {
       $head_title[] = variable_get('site_slogan', '');
     }
@@ -1894,7 +1894,7 @@ function template_preprocess_page(&$vari
   $variables['primary_links']     = theme_get_setting('toggle_primary_links') ? menu_primary_links() : array();
   $variables['secondary_links']   = theme_get_setting('toggle_secondary_links') ? menu_secondary_links() : array();
   $variables['search_box']        = (theme_get_setting('toggle_search') ? drupal_get_form('search_theme_form') : '');
-  $variables['site_name']         = (theme_get_setting('toggle_name') ? filter_xss_admin(variable_get('site_name', 'Pressflow')) : '');
+  $variables['site_name']         = (theme_get_setting('toggle_name') ? filter_xss_admin(variable_get('site_name', 'Pantheon')) : '');
   $variables['site_slogan']       = (theme_get_setting('toggle_slogan') ? filter_xss_admin(variable_get('site_slogan', '')) : '');
   $variables['css']               = drupal_add_css();
   $variables['styles']            = drupal_get_css();
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/includes/theme.maintenance.inc drops-6/includes/theme.maintenance.inc
--- pressflow6/includes/theme.maintenance.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/includes/theme.maintenance.inc	2016-05-18 14:57:13.000000000 -0700
@@ -233,10 +233,10 @@ function template_preprocess_maintenance
 
   // Construct page title
   if (drupal_get_title()) {
-    $head_title = array(strip_tags(drupal_get_title()), variable_get('site_name', 'Pressflow'));
+    $head_title = array(strip_tags(drupal_get_title()), variable_get('site_name', 'Pantheon'));
   }
   else {
-    $head_title = array(variable_get('site_name', 'Pressflow'));
+    $head_title = array(variable_get('site_name', 'Pantheon'));
     if (variable_get('site_slogan', '')) {
       $head_title[] = variable_get('site_slogan', '');
     }
@@ -256,7 +256,7 @@ function template_preprocess_maintenance
   $variables['primary_links']     = array();
   $variables['secondary_links']   = array();
   $variables['search_box']        = '';
-  $variables['site_name']         = (theme_get_setting('toggle_name') ? variable_get('site_name', 'Pressflow') : '');
+  $variables['site_name']         = (theme_get_setting('toggle_name') ? variable_get('site_name', 'Pantheon') : '');
   $variables['site_slogan']       = (theme_get_setting('toggle_slogan') ? variable_get('site_slogan', '') : '');
   $variables['css']               = drupal_add_css();
   $variables['styles']            = drupal_get_css();
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/install.php drops-6/install.php
--- pressflow6/install.php	2018-11-26 10:27:54.000000000 -0800
+++ drops-6/install.php	2016-05-18 14:57:13.000000000 -0700
@@ -560,7 +560,7 @@ function install_select_locale($profilen
         $output .= '<ul><li><a href="install.php?profile='. $profilename .'&amp;locale=en">'. st('Continue installation in English') .'</a></li><li><a href="install.php?profile='. $profilename .'">'. st('Return to choose a language') .'</a></li></ul>';
       }
       else {
-        $output = '<ul><li><a href="install.php?profile='. $profilename .'&amp;locale=en">'. st('Install Pressflow in English') .'</a></li><li><a href="install.php?profile='. $profilename .'&amp;localize=true">'. st('Learn how to install Pressflow in other languages') .'</a></li></ul>';
+        $output = '<ul><li><a href="install.php?profile='. $profilename .'&amp;locale=en">'. st('Install Pantheon in English') .'</a></li><li><a href="install.php?profile='. $profilename .'&amp;localize=true">'. st('Learn how to install Pantheon in other languages') .'</a></li></ul>';
       }
       print theme('install_page', $output);
       exit;
@@ -932,7 +932,7 @@ function install_check_requirements($pro
 <li>Copy the %default_file file to %file.</li>
 <li>Change file permissions so that it is writable by the web server. If you are unsure how to grant file permissions, please consult the <a href="@handbook_url">on-line handbook</a>.</li>
 </ol>
-More details about installing Pressflow are available in INSTALL.txt.', array('@drupal' => drupal_install_profile_name(), '%file' => $file, '%default_file' => $conf_path .'/default.settings.php', '@handbook_url' => 'http://drupal.org/server-permissions')), 'error');
+More details about installing Pantheon are available in INSTALL.txt.', array('@drupal' => drupal_install_profile_name(), '%file' => $file, '%default_file' => $conf_path .'/default.settings.php', '@handbook_url' => 'http://drupal.org/server-permissions')), 'error');
     }
     elseif (!$writable) {
       drupal_set_message(st('The @drupal installer requires write permissions to %file during the installation process. If you are unsure how to grant file permissions, please consult the <a href="@handbook_url">on-line handbook</a>.', array('@drupal' => drupal_install_profile_name(), '%file' => $file, '@handbook_url' => 'http://drupal.org/server-permissions')), 'error');
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/aggregator/aggregator.pages.inc drops-6/modules/aggregator/aggregator.pages.inc
--- pressflow6/modules/aggregator/aggregator.pages.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/aggregator/aggregator.pages.inc	2016-05-18 14:57:13.000000000 -0700
@@ -12,7 +12,7 @@
  *   The items HTML.
  */
 function aggregator_page_last() {
-  drupal_add_feed(url('aggregator/rss'), variable_get('site_name', 'Pressflow') .' '. t('aggregator'));
+  drupal_add_feed(url('aggregator/rss'), variable_get('site_name', 'Pantheon') .' '. t('aggregator'));
 
   $items = aggregator_feed_items_load('SELECT i.*, f.title AS ftitle, f.link AS flink FROM {aggregator_item} i INNER JOIN {aggregator_feed} f ON i.fid = f.fid ORDER BY i.timestamp DESC, i.iid DESC');
 
@@ -63,7 +63,7 @@ function aggregator_page_category($arg1,
   // $form_state and $arg2 is $category. Otherwise, $arg1 is $category.
   $category = is_array($arg2) ? $arg2 : $arg1;
 
-  drupal_add_feed(url('aggregator/rss/'. $category['cid']), variable_get('site_name', 'Pressflow') .' '. t('aggregator - @title', array('@title' => $category['title'])));
+  drupal_add_feed(url('aggregator/rss/'. $category['cid']), variable_get('site_name', 'Pantheon') .' '. t('aggregator - @title', array('@title' => $category['title'])));
 
   // It is safe to include the cid in the query because it's loaded from the
   // database by aggregator_category_load.
@@ -370,7 +370,7 @@ function theme_aggregator_page_rss($feed
     $items .= format_rss_item($feed->ftitle .': '. $feed->title, $feed->link, $feed->description, array('pubDate' => date('r', $feed->timestamp)));
   }
 
-  $site_name = variable_get('site_name', 'Pressflow');
+  $site_name = variable_get('site_name', 'Pantheon');
   $url = url((isset($category) ? 'aggregator/categories/'. $category->cid : 'aggregator'), array('absolute' => TRUE));
   $description = isset($category) ? t('@site_name - aggregated feeds in category @title', array('@site_name' => $site_name, '@title' => $category->title)) : t('@site_name - aggregated feeds', array('@site_name' => $site_name));
 
@@ -420,7 +420,7 @@ function theme_aggregator_page_opml($fee
   $output = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n";
   $output .= "<opml version=\"1.1\">\n";
   $output .= "<head>\n";
-  $output .= '<title>'. check_plain(variable_get('site_name', 'Pressflow')) ."</title>\n";
+  $output .= '<title>'. check_plain(variable_get('site_name', 'Pantheon')) ."</title>\n";
   $output .= '<dateModified>'. gmdate('r') ."</dateModified>\n";
   $output .= "</head>\n";
   $output .= "<body>\n";
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/blog/blog.pages.inc drops-6/modules/blog/blog.pages.inc
--- pressflow6/modules/blog/blog.pages.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/blog/blog.pages.inc	2016-05-18 14:57:13.000000000 -0700
@@ -102,7 +102,7 @@ function blog_feed_user($account) {
  */
 function blog_feed_last() {
   $result = db_query_range(db_rewrite_sql("SELECT n.nid, n.created FROM {node} n WHERE n.type = 'blog' AND n.status = 1 ORDER BY n.created DESC"), 0, variable_get('feed_default_items', 10));
-  $channel['title'] = t('!site_name blogs', array('!site_name' => variable_get('site_name', 'Pressflow')));
+  $channel['title'] = t('!site_name blogs', array('!site_name' => variable_get('site_name', 'Pantheon')));
   $channel['link'] = url('blog', array('absolute' => TRUE));
 
   $items = array();
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/contact/contact.module drops-6/modules/contact/contact.module
--- pressflow6/modules/contact/contact.module	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/contact/contact.module	2016-05-18 14:57:13.000000000 -0700
@@ -201,9 +201,9 @@ function contact_mail($key, &$message, $
     case 'user_copy':
       $user = $params['user'];
       $account = $params['account'];
-      $message['subject'] .= '['. variable_get('site_name', 'Pressflow') .'] '. $params['subject'];
+      $message['subject'] .= '['. variable_get('site_name', 'Pantheon') .'] '. $params['subject'];
       $message['body'][] = "$account->name,";
-      $message['body'][] = t("!name (!name-url) has sent you a message via your contact form (!form-url) at !site.", array('!name' => $user->name, '!name-url' => url("user/$user->uid", array('absolute' => TRUE, 'language' => $language)), '!form-url' => url($_GET['q'], array('absolute' => TRUE, 'language' => $language)), '!site' => variable_get('site_name', 'Pressflow')), $language->language);
+      $message['body'][] = t("!name (!name-url) has sent you a message via your contact form (!form-url) at !site.", array('!name' => $user->name, '!name-url' => url("user/$user->uid", array('absolute' => TRUE, 'language' => $language)), '!form-url' => url($_GET['q'], array('absolute' => TRUE, 'language' => $language)), '!site' => variable_get('site_name', 'Pantheon')), $language->language);
       $message['body'][] = t("If you don't want to receive such e-mails, you can change your settings at !url.", array('!url' => url("user/$account->uid", array('absolute' => TRUE, 'language' => $language))), $language->language);
       $message['body'][] = t('Message:', NULL, $language->language);
       $message['body'][] = $params['message'];
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/filter/filter.module drops-6/modules/filter/filter.module
--- pressflow6/modules/filter/filter.module	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/filter/filter.module	2016-05-18 14:57:13.000000000 -0700
@@ -187,7 +187,7 @@ function filter_filter_tips($delta, $for
 <p>This site allows HTML content. While learning all of HTML may feel intimidating, learning how to use a very small number of the most basic HTML "tags" is very easy. This table provides examples for each tag that is enabled on this site.</p>
 <p>For more information see W3C\'s <a href="http://www.w3.org/TR/html/">HTML Specifications</a> or use your favorite search engine to find other sites that explain HTML.</p>');
               $tips = array(
-                'a' => array( t('Anchors are used to make links to other pages.'), '<a href="'. $base_url .'">'. variable_get('site_name', 'Pressflow') .'</a>'),
+                'a' => array( t('Anchors are used to make links to other pages.'), '<a href="'. $base_url .'">'. variable_get('site_name', 'Pantheon') .'</a>'),
                 'br' => array( t('By default line break tags are automatically added, so use this tag to add additional ones. Use of this tag is different because it is not used with an open/close pair like all the others. Use the extra " /" inside the tag to maintain XHTML 1.0 compatibility'), t('Text with <br />line break')),
                 'p' => array( t('By default paragraph tags are automatically added, so use this tag to add additional ones.'), '<p>'. t('Paragraph one.') .'</p> <p>'. t('Paragraph two.') .'</p>'),
                 'strong' => array( t('Strong'), '<strong>'. t('Strong') .'</strong>'),
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/node/node.module drops-6/modules/node/node.module
--- pressflow6/modules/node/node.module	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/node/node.module	2016-05-18 14:57:13.000000000 -0700
@@ -1754,7 +1754,7 @@ function node_feed($nids = FALSE, $chann
 
   $channel_defaults = array(
     'version'     => '2.0',
-    'title'       => variable_get('site_name', 'Pressflow'),
+    'title'       => variable_get('site_name', 'Pantheon'),
     'link'        => $base_url,
     'description' => variable_get('site_mission', ''),
     'language'    => $language->language
@@ -1785,11 +1785,11 @@ function node_page_default() {
 
   if ($num_rows) {
     $feed_url = url('rss.xml', array('absolute' => TRUE));
-    drupal_add_feed($feed_url, variable_get('site_name', 'Pressflow') .' '. t('RSS'));
+    drupal_add_feed($feed_url, variable_get('site_name', 'Pantheon') .' '. t('RSS'));
     $output .= theme('pager', NULL, variable_get('default_nodes_main', 10));
   }
   else {
-    $default_message = t('<h1 class="title">Welcome to your new Pressflow website!</h1><p>Please follow these steps to set up and start using your website:</p>');
+    $default_message = t('<h1 class="title">Welcome to your new Pantheon website!</h1><p>Please follow these steps to set up and start using your website:</p>');
     $default_message .= '<ol>';
 
     $default_message .= '<li>'. t('<strong>Configure your website</strong> Once logged in, visit the <a href="@admin">administration section</a>, where you can <a href="@config">customize and configure</a> all aspects of your website.', array('@admin' => url('admin'), '@config' => url('admin/settings'))) .'</li>';
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/simpletest/simpletest.test drops-6/modules/simpletest/simpletest.test
--- pressflow6/modules/simpletest/simpletest.test	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/simpletest/simpletest.test	2016-05-18 14:57:13.000000000 -0700
@@ -54,7 +54,7 @@ class SimpleTestFunctionalTest extends D
       $this->drupalGet('node');
       $this->assertTrue($this->drupalGetHeader('Date'), t('An HTTP header was received.'));
 //      $this->assertTitle(t('Welcome to @site-name | @site-name', array('@site-name' => variable_get('site_name', 'Drupal'))), t('Site title matches.'));
-      $this->assertTitle(variable_get('site_name', 'Pressflow'), t('Site title matches.'));
+      $this->assertTitle(variable_get('site_name', 'Pantheon'), t('Site title matches.'));
       $this->assertNoTitle('Foo', t('Site title does not match.'));
       // Make sure that we are locked out of the installer when prefixing
       // using the user-agent header. This is an important security check.
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/system/system.admin.inc drops-6/modules/system/system.admin.inc
--- pressflow6/modules/system/system.admin.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/system/system.admin.inc	2016-05-18 14:57:13.000000000 -0700
@@ -18,7 +18,7 @@ function system_main_admin_page($arg = N
 
   // Check for status report errors.
   if (system_status(TRUE) && user_access('administer site configuration')) {
-    drupal_set_message(t('One or more problems were detected with your Pressflow installation. Check the <a href="@status">status report</a> for more information.', array('@status' => url('admin/reports/status'))), 'error');
+    drupal_set_message(t('One or more problems were detected with your Pantheon installation. Check the <a href="@status">status report</a> for more information.', array('@status' => url('admin/reports/status'))), 'error');
   }
   $blocks = array();
   if ($admin = db_fetch_array(db_query("SELECT menu_name, mlid FROM {menu_links} WHERE link_path = 'admin' AND module = 'system'"))) {
@@ -1155,7 +1155,7 @@ function system_site_information_setting
   $form['site_name'] = array(
     '#type' => 'textfield',
     '#title' => t('Name'),
-    '#default_value' => variable_get('site_name', 'Pressflow'),
+    '#default_value' => variable_get('site_name', 'Pantheon'),
     '#description' => t('The name of this website.'),
     '#required' => TRUE
   );
@@ -1280,7 +1280,7 @@ function system_logging_overview() {
  */
 function system_performance_settings() {
 
-  $description = '<p>'. t("The normal cache mode is suitable for most sites and does not cause any side effects. The aggressive cache mode causes Pressflow to skip the loading (boot) and unloading (exit) of enabled modules when serving a cached page. This results in an additional performance boost but can cause unwanted side effects.") .'</p>';
+  $description = '<p>'. t("The normal cache mode is suitable for most sites and does not cause any side effects. The aggressive cache mode causes Pantheon to skip the loading (boot) and unloading (exit) of enabled modules when serving a cached page. This results in an additional performance boost but can cause unwanted side effects.") .'</p>';
 
   $problem_modules = array_unique(array_merge(module_implements('boot'), module_implements('exit')));
   sort($problem_modules);
@@ -1294,7 +1294,7 @@ function system_performance_settings() {
   $form['page_cache'] = array(
     '#type' => 'fieldset',
     '#title' => t('Page cache'),
-    '#description' => t('Enabling the page cache will offer a significant performance boost. Pressflow can store and send compressed cached pages requested by <em>anonymous</em> users. By caching a web page, Pressflow does not have to construct the page each time it is viewed.'),
+    '#description' => t('Enabling the page cache will offer a significant performance boost. Pantheon can store and send compressed cached pages requested by <em>anonymous</em> users. By caching a web page, Pantheon does not have to construct the page each time it is viewed.'),
   );
 
   $form['page_cache']['cache'] = array(
@@ -1331,7 +1331,7 @@ function system_performance_settings() {
     '#title' => t('Page compression'),
     '#default_value' => variable_get('page_compression', TRUE),
     '#options' => array(t('Disabled'), t('Enabled')),
-    '#description' => t("By default, Pressflow compresses the pages it caches in order to save bandwidth and improve download times. This option should be disabled when using a webserver that performs compression."),
+    '#description' => t("By default, Pantheon compresses the pages it caches in order to save bandwidth and improve download times. This option should be disabled when using a webserver that performs compression."),
   );
 
   $form['block_cache'] = array(
@@ -1687,7 +1687,7 @@ function system_site_maintenance_setting
   $form['site_offline_message'] = array(
     '#type' => 'textarea',
     '#title' => t('Site off-line message'),
-    '#default_value' => variable_get('site_offline_message', t('@site is currently under maintenance. We should be back shortly. Thank you for your patience.', array('@site' => variable_get('site_name', 'Pressflow')))),
+    '#default_value' => variable_get('site_offline_message', t('@site is currently under maintenance. We should be back shortly. Thank you for your patience.', array('@site' => variable_get('site_name', 'Pantheon')))),
     '#description' => t('Message to show visitors when the site is in off-line mode.')
   );
 
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/system/system.install drops-6/modules/system/system.install
--- pressflow6/modules/system/system.install	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/system/system.install	2016-05-18 14:57:13.000000000 -0700
@@ -11,7 +11,7 @@ function system_requirements($phase) {
   // Report Drupal version
   if ($phase == 'runtime') {
     $requirements['drupal'] = array(
-      'title' => $t('Pressflow'),
+      'title' => $t('Pantheon'),
       'value' => VERSION,
       'severity' => REQUIREMENT_INFO,
       'weight' => -10,
@@ -134,8 +134,9 @@ function system_requirements($phase) {
     foreach ($htaccess_files as $key => $file_info) {
       // Check for the string which was added to the recommended .htaccess file
       // in the latest security update.
+      // Ignore on Pantheon, which does not use .htaccess.
       $htaccess_file = $file_info['directory'] . '/.htaccess';
-      if (!file_exists($htaccess_file) || !($contents = @file_get_contents($htaccess_file)) || strpos($contents, 'Drupal_Security_Do_Not_Remove_See_SA_2013_003') === FALSE) {
+      if (!isset($_SERVER['PANTHEON_ENVIRONMENT']) && (!file_exists($htaccess_file) || !($contents = @file_get_contents($htaccess_file)) || strpos($contents, 'Drupal_Security_Do_Not_Remove_See_SA_2013_003') === FALSE)) {
         $requirements[$key] = array(
           'title' => $file_info['title'],
           'value' => $t('Not fully protected'),
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/system/system.module drops-6/modules/system/system.module
--- pressflow6/modules/system/system.module	2018-11-26 10:27:54.000000000 -0800
+++ drops-6/modules/system/system.module	2018-04-25 14:17:08.000000000 -0700
@@ -581,7 +581,7 @@ function system_block($op = 'list', $del
   switch ($op) {
     case 'list':
       $blocks[0] = array(
-        'info' => t('Powered by Pressflow'),
+        'info' => t('Powered by Pantheon'),
         'weight' => '10',
          // Not worth caching.
         'cache' => BLOCK_NO_CACHE,
@@ -1799,7 +1799,7 @@ function system_mail($key, &$message, $p
   $account = $params['account'];
   $context = $params['context'];
   $variables = array(
-    '%site_name' => variable_get('site_name', 'Pressflow'),
+    '%site_name' => variable_get('site_name', 'Pantheon'),
     '%username' => $account->name,
   );
   if ($context['hook'] == 'taxonomy') {
@@ -1855,7 +1855,7 @@ function system_message_action_submit($f
 function system_message_action(&$object, $context = array()) {
   global $user;
   $variables = array(
-    '%site_name' => variable_get('site_name', 'Pressflow'),
+    '%site_name' => variable_get('site_name', 'Pantheon'),
     '%username' => $user->name ? $user->name : variable_get('anonymous', t('Anonymous')),
   );
 
@@ -1970,6 +1970,6 @@ function system_check_http_request() {
  * @ingroup themeable
  */
 function theme_system_powered_by($image_path) {
-  $image = theme('image', $image_path, t('Powered by Pressflow, an open source content management system'), t('Powered by Pressflow, an open source content management system'));
+  $image = theme('image', $image_path, t('Powered by Pantheon, an open source content management system'), t('Powered by Pantheon, an open source content management system'));
   return l($image, 'http://drupal.org', array('html' => TRUE, 'absolute' => TRUE, 'external' => TRUE));
 }
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/taxonomy/taxonomy.pages.inc drops-6/modules/taxonomy/taxonomy.pages.inc
--- pressflow6/modules/taxonomy/taxonomy.pages.inc	2018-11-26 10:27:54.000000000 -0800
+++ drops-6/modules/taxonomy/taxonomy.pages.inc	2016-05-18 14:57:13.000000000 -0700
@@ -47,7 +47,7 @@ function taxonomy_term_page($str_tids = 
 
         case 'feed':
           $channel['link'] = url('taxonomy/term/'. $str_tids .'/'. $depth, array('absolute' => TRUE));
-          $channel['title'] = variable_get('site_name', 'Pressflow') .' - '. $title;
+          $channel['title'] = variable_get('site_name', 'Pantheon') .' - '. $title;
           // Only display the description if we have a single term, to avoid clutter and confusion.
           if (count($tids) == 1) {
             $term = taxonomy_get_term($tids[0]);
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/update/update.compare.inc drops-6/modules/update/update.compare.inc
--- pressflow6/modules/update/update.compare.inc	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/update/update.compare.inc	2016-05-18 14:57:13.000000000 -0700
@@ -110,6 +110,7 @@ function _update_process_info_list(&$pro
       // Drupal core is always required, so this extra info would be noise.
       $sub_themes = array();
       $base_themes = array();
+      $file->info['version'] = VERSION;
     }
     else {
       // Add list of enabled sub-themes.
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/update/update.module drops-6/modules/update/update.module
--- pressflow6/modules/update/update.module	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/update/update.module	2016-05-18 14:57:13.000000000 -0700
@@ -400,15 +400,30 @@ function update_refresh() {
  * @see drupal_mail()
  * @see _update_cron_notify()
  * @see _update_message_text()
+ *
+ * This function is updated by Pantheon to direct users to their dashboard for
+ * core updates. Hence the $core variable, etc.
  */
 function update_mail($key, &$message, $params) {
+  $core = FALSE;
   $language = $message['language'];
   $langcode = $language->language;
-  $message['subject'] .= t('New release(s) available for !site_name', array('!site_name' => variable_get('site_name', 'Pressflow')), $langcode);
+  $message['subject'] .= t('New release(s) available for !site_name', array('!site_name' => variable_get('site_name', 'Pantheon')), $langcode);
   foreach ($params as $msg_type => $msg_reason) {
+    if ($msg_type == 'core') {
+      $core = TRUE;
+    }
     $message['body'][] = _update_message_text($msg_type, $msg_reason, FALSE, $language);
   }
   $message['body'][] = t('See the available updates page for more information:', array(), $langcode) ."\n". url('admin/reports/updates', array('absolute' => TRUE, 'language' => $language));
+  if ($core) {
+    // Add Pantheon link to beginning/end of mesage.
+    // TODO: have the $dashboard link directly to the site.
+    $dashboard = 'https://dashboard.getpantheon.com/account';
+    $text = t('Drupal core updates should be performed directly from <a href="@link">your Pantheon dashboard</a>.', array('@link' => $dashboard));
+    array_unshift($message['body'], $text);
+    $message['body'][] = t('Core updates should be performed directly from your Pantheon dashboard:', array(), $langcode) ."\n$dashboard";
+  }
 }
 
 /**
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/modules/user/user.module drops-6/modules/user/user.module
--- pressflow6/modules/user/user.module	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/modules/user/user.module	2016-05-18 14:57:13.000000000 -0700
@@ -1307,7 +1307,7 @@ function user_login(&$form_state) {
     '#required' => TRUE,
   );
 
-  $form['name']['#description'] = t('Enter your @s username.', array('@s' => variable_get('site_name', 'Pressflow')));
+  $form['name']['#description'] = t('Enter your @s username.', array('@s' => variable_get('site_name', 'Pantheon')));
   $form['pass'] = array('#type' => 'password',
     '#title' => t('Password'),
     '#description' => t('Enter the password that accompanies your username.'),
@@ -2176,7 +2176,7 @@ function user_mail_tokens($account, $lan
   global $base_url;
   $tokens = array(
     '!username' => $account->name,
-    '!site' => variable_get('site_name', 'Pressflow'),
+    '!site' => variable_get('site_name', 'Pantheon'),
     '!login_url' => user_pass_reset_url($account),
     '!uri' => $base_url,
     '!uri_brief' => preg_replace('!^https?://!', '', $base_url),
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/profiles/default/default.profile drops-6/profiles/default/default.profile
--- pressflow6/profiles/default/default.profile	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/profiles/default/default.profile	2016-05-18 14:57:13.000000000 -0700
@@ -2,12 +2,21 @@
 
 /**
  * Return an array of the modules to be enabled when this profile is installed.
+ * Order is important.
  *
  * @return
  *   An array of modules to enable.
  */
 function default_profile_modules() {
-  return array('color', 'comment', 'help', 'menu', 'taxonomy', 'dblog');
+  return array(
+    // core: swap dblog for syslog
+    'color', 'comment', 'cookie_cache_bypass', 'help', 'menu', 'taxonomy', 'syslog', 'locale', 'search', 'update', 'dblog',
+
+    // contrib: varnish, apachesolr, etc
+    // 'varnish', 'apachesolr', 'apachesolr_search',
+    'pantheon_api', 'pantheon_login'
+  );
+
 }
 
 /**
@@ -20,63 +29,15 @@ function default_profile_modules() {
  */
 function default_profile_details() {
   return array(
-    'name' => 'Pressflow',
-    'description' => 'Select this profile to enable some basic Drupal functionality and the default theme.'
-  );
-}
+    'name' => 'Pantheon',
+    'description' => 'A high-performance stack including support for Varnish.',
 
-/**
- * Return a list of tasks that this profile supports.
- *
- * @return
- *   A keyed array of tasks the profile will perform during
- *   the final stage. The keys of the array will be used internally,
- *   while the values will be displayed to the user in the installer
- *   task list.
- */
-function default_profile_task_list() {
+  );
 }
 
 /**
  * Perform any final installation tasks for this profile.
  *
- * The installer goes through the profile-select -> locale-select
- * -> requirements -> database -> profile-install-batch
- * -> locale-initial-batch -> configure -> locale-remaining-batch
- * -> finished -> done tasks, in this order, if you don't implement
- * this function in your profile.
- *
- * If this function is implemented, you can have any number of
- * custom tasks to perform after 'configure', implementing a state
- * machine here to walk the user through those tasks. First time,
- * this function gets called with $task set to 'profile', and you
- * can advance to further tasks by setting $task to your tasks'
- * identifiers, used as array keys in the hook_profile_task_list()
- * above. You must avoid the reserved tasks listed in
- * install_reserved_tasks(). If you implement your custom tasks,
- * this function will get called in every HTTP request (for form
- * processing, printing your information screens and so on) until
- * you advance to the 'profile-finished' task, with which you
- * hand control back to the installer. Each custom page you
- * return needs to provide a way to continue, such as a form
- * submission or a link. You should also set custom page titles.
- *
- * You should define the list of custom tasks you implement by
- * returning an array of them in hook_profile_task_list(), as these
- * show up in the list of tasks on the installer user interface.
- *
- * Remember that the user will be able to reload the pages multiple
- * times, so you might want to use variable_set() and variable_get()
- * to remember your data and control further processing, if $task
- * is insufficient. Should a profile want to display a form here,
- * it can; the form should set '#redirect' to FALSE, and rely on
- * an action in the submit handler, such as variable_set(), to
- * detect submission and proceed to further tasks. See the configuration
- * form handling code in install_tasks() for an example.
- *
- * Important: Any temporary variables should be removed using
- * variable_del() before advancing to the 'profile-finished' phase.
- *
  * @param $task
  *   The current $task of the install system. When hook_profile_tasks()
  *   is first called, this is 'profile'.
@@ -132,19 +93,29 @@ function default_profile_tasks(&$task, $
   $theme_settings['toggle_node_info_page'] = FALSE;
   variable_set('theme_settings', $theme_settings);
 
+  // Adjust settings on admin/settings/performance.
+  variable_set('cache', CACHE_EXTERNAL);
+  variable_set('page_cache_max_age', 900);
+  variable_set('block_cache', TRUE);
+  variable_set('page_compression', 0); // We do this via mod_deflate.
+  variable_set('preprocess_js', TRUE);
+  variable_set('preprocess_css', TRUE);
+
+  // Set correct ApacheSolr port for Pantheon.
+  variable_set('apachesolr_search_make_default', 1);
+  variable_set('apachesolr_search_spellcheck', TRUE);
+
+  // Set some permissions in the only ugly way possible
+  // To extend this, just add more 'role_id' => array('perms') items to the array
+  $perms = array(
+    1 => array('access content', 'search content', 'use advanced search'),
+    2 => array('access comments', 'access content', 'post comments', 'post comments without approval', 'search content', 'use advanced search'),
+  );
+  foreach($perms as $role_id => $perms) {
+    db_query('DELETE FROM {permission} WHERE rid = %d', $role_id);
+    db_query("INSERT INTO {permission} (rid, perm) VALUES (%d, '%s')", $role_id, implode(', ', $perms));
+  }
+
   // Update the menu router information.
   menu_rebuild();
 }
-
-/**
- * Implementation of hook_form_alter().
- *
- * Allows the profile to alter the site-configuration form. This is
- * called through custom invocation, so $form_state is not populated.
- */
-function default_form_alter(&$form, $form_state, $form_id) {
-  if ($form_id == 'install_configure') {
-    // Set default for site name field.
-    $form['site_information']['site_name']['#default_value'] = $_SERVER['SERVER_NAME'];
-  }
-}
diff -x .git -x .drush-lock-update -x .gitignore -x favicon.ico -x healthchecks -x pantheon -x pantheon.upstream.yml -x openid.install -x logo.png -Nupr pressflow6/themes/chameleon/chameleon.theme drops-6/themes/chameleon/chameleon.theme
--- pressflow6/themes/chameleon/chameleon.theme	2018-11-26 10:22:35.000000000 -0800
+++ drops-6/themes/chameleon/chameleon.theme	2016-05-18 14:57:13.000000000 -0700
@@ -30,7 +30,7 @@ function chameleon_page($content, $show_
   $output .= "<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"$language\" xml:lang=\"$language\" dir=\"$direction\">\n";
   $output .= "<head>\n";
   $output .= drupal_get_html_head();
-  $output .= " <title>". ($title ? strip_tags($title) ." | ". variable_get("site_name", "Pressflow") : variable_get("site_name", "Pressflow") ." | ". variable_get("site_slogan", "")) ."</title>\n";
+  $output .= " <title>". ($title ? strip_tags($title) ." | ". variable_get("site_name", "Pantheon") : variable_get("site_name", "Pantheon") ." | ". variable_get("site_slogan", "")) ."</title>\n";
   $output .= drupal_get_css();
   $output .= drupal_get_js();
   $output .= "</head>";
